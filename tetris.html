<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tetris</title>
  <style>
    body {
      background-color: #111;
      color: white;
      text-align: center;
      font-family: sans-serif;
    }

    h1 {
      margin-top: 20px;
    }

    #tetris {
      display: grid;
      grid-template-columns: repeat(10, 30px);
      grid-template-rows: repeat(20, 30px);
      gap: 1px;
      margin: 20px auto;
      width: max-content;
      background-color: #222;
    }

    .cell {
      width: 30px;
      height: 30px;
      background-color: #111;
      border: 1px solid #333;
    }

    .filled {
      background-color: #4caf50;
    }
  </style>
</head>
<body>
  <h1>Tetris</h1>
  <div id="tetris"></div>
  <p>Use arrow keys to move and rotate</p>

  <script>
    const ROWS = 20;
    const COLS = 10;
    const board = [];
    const tetris = document.getElementById("tetris");

    for (let i = 0; i < ROWS; i++) {
      const row = [];
      for (let j = 0; j < COLS; j++) {
        const cell = document.createElement("div");
        cell.classList.add("cell");
        tetris.appendChild(cell);
        row.push(cell);
      }
      board.push(row);
    }

const tetrominoes = {
  I: [[0, 3], [0, 4], [0, 5], [0, 6]],
  O: [[0, 4], [0, 5], [1, 4], [1, 5]],
  T: [[0, 3], [0, 4], [0, 5], [1, 4]],
  L: [[0, 4], [1, 4], [2, 4], [2, 5]],
  J: [[0, 5], [1, 5], [2, 5], [2, 4]],
  S: [[0, 4], [0, 5], [1, 3], [1, 4]],
  Z: [[0, 3], [0, 4], [1, 4], [1, 5]]
};
    let current = {
      shape: "T",
      coords: [],
    };

    function drawTetromino(coords, fill = true) {
      coords.forEach(([r, c]) => {
        if (board[r] && board[r][c]) {
          board[r][c].classList.toggle("filled", fill);
        }
      });
    }

    function getNewTetromino() {
      const shapes = Object.keys(tetrominoes);
      const shape = shapes[Math.floor(Math.random() * shapes.length)];
      return { shape, coords: tetrominoes[shape].map(c => [...c]) };
    }

    function moveTetromino(dr, dc) {
      const moved = current.coords.map(([r, c]) => [r + dr, c + dc]);
      if (validMove(moved)) {
        drawTetromino(current.coords, false);
        current.coords = moved;
        drawTetromino(current.coords);
        return true;
      }
      return false;
    }

    function rotateTetromino() {
      const [r0, c0] = current.coords[0];
      const rotated = current.coords.map(([r, c]) => {
        const dr = r - r0;
        const dc = c - c0;
        return [r0 - dc, c0 + dr];
      });

      if (validMove(rotated)) {
        drawTetromino(current.coords, false);
        current.coords = rotated;
        drawTetromino(current.coords);
      }
    }

    function validMove(coords) {
      return coords.every(([r, c]) =>
        r >= 0 && r < ROWS &&
        c >= 0 && c < COLS &&
        !board[r][c].classList.contains("filled")
      );
    }

    function dropTetromino() {
      if (!moveTetromino(1, 0)) {
        current.coords.forEach(([r, c]) => board[r][c].classList.add("filled"));
        clearLines();
        current = getNewTetromino();
        if (!validMove(current.coords)) {
          alert("Game Over");
          location.reload();
        }
        drawTetromino(current.coords);
      }
    }

    function clearLines() {
      for (let r = ROWS - 1; r >= 0; r--) {
        if (board[r].every(cell => cell.classList.contains("filled"))) {
          board[r].forEach(cell => cell.classList.remove("filled"));
          for (let rr = r; rr > 0; rr--) {
            for (let c = 0; c < COLS; c++) {
              board[rr][c].classList.toggle("filled",
                board[rr - 1][c].classList.contains("filled")
              );
            }
          }
          r++;
        }
      }
    }

    document.addEventListener("keydown", e => {
      if (e.key === "ArrowLeft") moveTetromino(0, -1);
      else if (e.key === "ArrowRight") moveTetromino(0, 1);
      else if (e.key === "ArrowDown") dropTetromino();
      else if (e.key === "ArrowUp") rotateTetromino();
    });

    function gameLoop() {
      dropTetromino();
      setTimeout(gameLoop, 600);
    }

    current = getNewTetromino();
    drawTetromino(current.coords);
    gameLoop();
  </script>
</body>
</html>
